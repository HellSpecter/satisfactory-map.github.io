<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satisfactory Interactive Map</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a2e;
            color: #e0e0e0;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background-color: #16213e;
            padding: 15px 20px;
            border-bottom: 2px solid #0f3460;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        .header h1 {
            color: #4cc9f0;
            font-size: 1.8rem;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .zoom-controls {
            display: flex;
            gap: 5px;
            background-color: #0f3460;
            padding: 5px;
            border-radius: 5px;
        }
        
        button {
            background-color: #4cc9f0;
            color: #16213e;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #3aa8d8;
        }
        
        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .map-container {
            flex: 1;
            position: relative;
            overflow: hidden;
            background-color: #0a0a1a;
        }
        
        #map-image {
            position: absolute;
            cursor: grab;
            transform-origin: 0 0;
            transition: transform 0.1s;
            user-select: none;
        }
        
        #map-image.dragging {
            cursor: grabbing;
        }
        
        .checkbox-container {
            position: absolute;
            z-index: 10;
        }
        
        .checkbox-container input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #4cc9f0;
        }
        
        .checkbox-container .tooltip {
            visibility: hidden;
            position: absolute;
            background-color: rgba(22, 33, 62, 0.95);
            color: #e0e0e0;
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #4cc9f0;
            width: 200px;
            top: 25px;
            left: 0;
            z-index: 100;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .checkbox-container:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
        
        .sidebar {
            width: 300px;
            background-color: #16213e;
            border-left: 2px solid #0f3460;
            padding: 20px;
            overflow-y: auto;
            flex-shrink: 0;
        }
        
        .sidebar h2 {
            color: #4cc9f0;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #0f3460;
        }
        
        .checkbox-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            background-color: rgba(15, 52, 96, 0.3);
            border-radius: 5px;
            transition: background-color 0.2s;
        }
        
        .checkbox-item:hover {
            background-color: rgba(15, 52, 96, 0.5);
        }
        
        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #4cc9f0;
        }
        
        .checkbox-item label {
            cursor: pointer;
            flex: 1;
        }
        
        .status-bar {
            background-color: #0f3460;
            padding: 8px 20px;
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
            flex-shrink: 0;
        }
        
        .instructions {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(15, 52, 96, 0.3);
            border-radius: 5px;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .instructions h3 {
            color: #4cc9f0;
            margin-bottom: 8px;
        }
        
        .instructions ul {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 5px;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: 250px;
                border-left: none;
                border-top: 2px solid #0f3460;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Satisfactory Interactive Map</h1>
        <div class="controls">
            <div class="zoom-controls">
                <button id="zoom-in">+</button>
                <button id="zoom-out">-</button>
                <button id="reset-view">Сброс</button>
            </div>
            <button id="toggle-checkboxes">Показать/скрыть метки</button>
        </div>
    </div>
    
    <div class="container">
        <div class="map-container" id="map-container">
            <img id="map-image" src="images/map.jpg" alt="Satisfactory Map">
            
            <!-- Чекбоксы будут добавлены с помощью JavaScript -->
        </div>
        
        <div class="sidebar">
            <h2>Объекты на карте</h2>
            <div class="checkbox-list" id="checkbox-list">
                <!-- Список чекбоксов будет добавлен с помощью JavaScript -->
            </div>
            
            <div class="instructions">
                <h3>Управление картой</h3>
                <ul>
                    <li><strong>Колёсико мыши</strong> - приближение/отдаление</li>
                    <li><strong>ЛКМ + перетаскивание</strong> - перемещение по карте</li>
                    <li><strong>Двойной клик</strong> - сброс масштаба и положения</li>
                    <li><strong>Наведите на метку</strong> - чтобы увидеть описание</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="status-bar">
        <div>Масштаб: <span id="zoom-level">100%</span></div>
        <div>Координаты: <span id="coordinates">x: 0, y: 0</span></div>
        <div>Выбрано объектов: <span id="selected-count">0</span></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Элементы DOM
            const mapContainer = document.getElementById('map-container');
            const mapImage = document.getElementById('map-image');
            const zoomInBtn = document.getElementById('zoom-in');
            const zoomOutBtn = document.getElementById('zoom-out');
            const resetViewBtn = document.getElementById('reset-view');
            const toggleCheckboxesBtn = document.getElementById('toggle-checkboxes');
            const zoomLevelElement = document.getElementById('zoom-level');
            const coordinatesElement = document.getElementById('coordinates');
            const selectedCountElement = document.getElementById('selected-count');
            const checkboxListElement = document.getElementById('checkbox-list');
            
            // Параметры карты
            const mapWidth = 5112;
            const mapHeight = 5112;
            let scale = 1;
            let offsetX = 0;
            let offsetY = 0;
            let isDragging = false;
            let startX, startY;
            let initialOffsetX, initialOffsetY;
            let checkboxesVisible = true;
            
            // Координаты для чекбоксов
            const checkboxData = [
                { id: 1, x: 1024, y: 1212, label: "Месторождение железной руды", tooltip: "Богатое месторождение железной руды. Идеально для начала добычи." },
                { id: 2, x: 1869, y: 788, label: "Залежи меди", tooltip: "Крупные залежи медной руды. Необходимы для производства проводов и электроники." }
            ];
            
            // Инициализация карты
            function initMap() {
                // Устанавливаем начальное положение карты по центру
                offsetX = (mapContainer.clientWidth - mapWidth) / 2;
                offsetY = (mapContainer.clientHeight - mapHeight) / 2;
                updateMapTransform();
                
                // Создаем чекбоксы на карте
                createCheckboxes();
                
                // Обновляем счетчик выбранных объектов
                updateSelectedCount();
                
                // Обновляем информацию о координатах
                updateCoordinatesInfo();
            }
            
            // Создание чекбоксов на карте и в сайдбаре
            function createCheckboxes() {
                // Очищаем списки
                mapContainer.querySelectorAll('.checkbox-container').forEach(el => el.remove());
                checkboxListElement.innerHTML = '';
                
                // Создаем чекбоксы для каждой точки
                checkboxData.forEach(item => {
                    // Создаем чекбокс на карте
                    const checkboxContainer = document.createElement('div');
                    checkboxContainer.className = 'checkbox-container';
                    checkboxContainer.style.left = `${item.x}px`;
                    checkboxContainer.style.top = `${item.y}px`;
                    
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.id = `map-checkbox-${item.id}`;
                    checkbox.dataset.id = item.id;
                    
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.textContent = item.tooltip;
                    
                    checkboxContainer.appendChild(checkbox);
                    checkboxContainer.appendChild(tooltip);
                    mapContainer.appendChild(checkboxContainer);
                    
                    // Создаем элемент в сайдбаре
                    const listItem = document.createElement('div');
                    listItem.className = 'checkbox-item';
                    
                    const sidebarCheckbox = document.createElement('input');
                    sidebarCheckbox.type = 'checkbox';
                    sidebarCheckbox.id = `sidebar-checkbox-${item.id}`;
                    sidebarCheckbox.dataset.id = item.id;
                    
                    const label = document.createElement('label');
                    label.htmlFor = `sidebar-checkbox-${item.id}`;
                    label.textContent = item.label;
                    
                    listItem.appendChild(sidebarCheckbox);
                    listItem.appendChild(label);
                    checkboxListElement.appendChild(listItem);
                    
                    // Связываем чекбоксы на карте и в сайдбаре
                    checkbox.addEventListener('change', function() {
                        document.getElementById(`sidebar-checkbox-${item.id}`).checked = this.checked;
                        updateSelectedCount();
                    });
                    
                    sidebarCheckbox.addEventListener('change', function() {
                        document.getElementById(`map-checkbox-${item.id}`).checked = this.checked;
                        updateSelectedCount();
                    });
                });
            }
            
            // Обновление счетчика выбранных объектов
            function updateSelectedCount() {
                const selectedCheckboxes = document.querySelectorAll('.checkbox-container input[type="checkbox"]:checked');
                selectedCountElement.textContent = selectedCheckboxes.length;
            }
            
            // Обновление трансформации карты
            function updateMapTransform() {
                mapImage.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
                zoomLevelElement.textContent = `${Math.round(scale * 100)}%`;
                
                // Обновляем позиции чекбоксов при изменении масштаба
                updateCheckboxPositions();
            }
            
            // Обновление позиций чекбоксов при изменении масштаба
            function updateCheckboxPositions() {
                document.querySelectorAll('.checkbox-container').forEach(container => {
                    const checkboxId = container.querySelector('input').dataset.id;
                    const checkboxItem = checkboxData.find(item => item.id == checkboxId);
                    
                    if (checkboxItem) {
                        // Позиционируем чекбокс с учетом масштаба и смещения
                        const x = checkboxItem.x * scale + offsetX;
                        const y = checkboxItem.y * scale + offsetY;
                        
                        container.style.transform = `translate(${x}px, ${y}px) scale(${1/scale})`;
                        container.style.display = checkboxesVisible ? 'block' : 'none';
                    }
                });
            }
            
            // Обновление информации о координатах
            function updateCoordinatesInfo() {
                // Координаты центра экрана относительно карты
                const centerX = Math.round((-offsetX + mapContainer.clientWidth / 2) / scale);
                const centerY = Math.round((-offsetY + mapContainer.clientHeight / 2) / scale);
                
                // Ограничиваем координаты размерами карты
                const boundedX = Math.max(0, Math.min(mapWidth, centerX));
                const boundedY = Math.max(0, Math.min(mapHeight, centerY));
                
                coordinatesElement.textContent = `x: ${boundedX}, y: ${boundedY}`;
            }
            
            // Ограничение смещения, чтобы карта не выходила за границы контейнера
            function constrainOffset() {
                const maxOffsetX = mapContainer.clientWidth - mapWidth * scale;
                const maxOffsetY = mapContainer.clientHeight - mapHeight * scale;
                
                offsetX = Math.min(0, Math.max(maxOffsetX, offsetX));
                offsetY = Math.min(0, Math.max(maxOffsetY, offsetY));
            }
            
            // Обработчики событий для масштабирования
            mapContainer.addEventListener('wheel', function(e) {
                e.preventDefault();
                
                const rect = mapContainer.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                const mouseY = e.clientY - rect.top;
                
                // Координаты мыши относительно карты до масштабирования
                const prevX = (mouseX - offsetX) / scale;
                const prevY = (mouseY - offsetY) / scale;
                
                // Изменение масштаба
                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                scale *= delta;
                
                // Ограничиваем масштаб
                scale = Math.max(0.1, Math.min(5, scale));
                
                // Корректируем смещение, чтобы точка под курсором оставалась на месте
                offsetX = mouseX - prevX * scale;
                offsetY = mouseY - prevY * scale;
                
                constrainOffset();
                updateMapTransform();
                updateCoordinatesInfo();
            });
            
            // Обработчики событий для перетаскивания
            mapContainer.addEventListener('mousedown', function(e) {
                if (e.button === 0) { // Левая кнопка мыши
                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    initialOffsetX = offsetX;
                    initialOffsetY = offsetY;
                    mapImage.classList.add('dragging');
                    mapContainer.style.cursor = 'grabbing';
                }
            });
            
            document.addEventListener('mousemove', function(e) {
                if (isDragging) {
                    offsetX = initialOffsetX + (e.clientX - startX);
                    offsetY = initialOffsetY + (e.clientY - startY);
                    
                    constrainOffset();
                    updateMapTransform();
                    updateCoordinatesInfo();
                }
            });
            
            document.addEventListener('mouseup', function() {
                if (isDragging) {
                    isDragging = false;
                    mapImage.classList.remove('dragging');
                    mapContainer.style.cursor = 'grab';
                }
            });
            
            // Двойной клик для сброса
            mapContainer.addEventListener('dblclick', function(e) {
                e.preventDefault();
                resetView();
            });
            
            // Кнопки управления
            zoomInBtn.addEventListener('click', function() {
                scale *= 1.2;
                scale = Math.min(5, scale);
                constrainOffset();
                updateMapTransform();
                updateCoordinatesInfo();
            });
            
            zoomOutBtn.addEventListener('click', function() {
                scale *= 0.8;
                scale = Math.max(0.1, scale);
                constrainOffset();
                updateMapTransform();
                updateCoordinatesInfo();
            });
            
            resetViewBtn.addEventListener('click', resetView);
            
            toggleCheckboxesBtn.addEventListener('click', function() {
                checkboxesVisible = !checkboxesVisible;
                updateCheckboxPositions();
                this.textContent = checkboxesVisible ? 'Скрыть метки' : 'Показать метки';
            });
            
            // Функция сброса вида
            function resetView() {
                scale = 1;
                offsetX = (mapContainer.clientWidth - mapWidth) / 2;
                offsetY = (mapContainer.clientHeight - mapHeight) / 2;
                updateMapTransform();
                updateCoordinatesInfo();
            }
            
            // Обработка изменения размера окна
            window.addEventListener('resize', function() {
                constrainOffset();
                updateMapTransform();
                updateCoordinatesInfo();
            });
            
            // Инициализация при загрузке
            initMap();
            
            // Обновление координат при движении мыши по карте
            mapContainer.addEventListener('mousemove', function(e) {
                if (isDragging) return;
                
                const rect = mapContainer.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                const mouseY = e.clientY - rect.top;
                
                // Координаты мыши относительно карты
                const mapX = Math.round((mouseX - offsetX) / scale);
                const mapY = Math.round((mouseY - offsetY) / scale);
                
                // Ограничиваем координаты размерами карты
                const boundedX = Math.max(0, Math.min(mapWidth, mapX));
                const boundedY = Math.max(0, Math.min(mapHeight, mapY));
                
                coordinatesElement.textContent = `x: ${boundedX}, y: ${boundedY}`;
            });
        });
    </script>
</body>
</html>
